<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Научная деятельность — Сергиево-Посадский музей-заповедник</title>
  <meta name="description" content="Научная деятельность Сергиево-Посадского музея-заповедника">

  <!-- Fonts -->
  <link rel="stylesheet" href="/assets/css/fonts.css">

  <!-- x-cloak FIX -->
  <style>
    [x-cloak] { display: none !important; }
  </style>

  <!-- Tailwind 4 -->
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-white text-[#24272A]">

  <!-- HEADER / MENUS -->
  <div data-include="/tpl/header.html"></div>
  <div data-include="/tpl/menu.html"></div>
  <div data-include="/tpl/menu-mobile.html"></div>

  <!-- ================= MAIN ================= -->
  <main class="max-w-[1600px] mx-auto px-4 sm:px-8 lg:px-[60px]">

    <!-- BREADCRUMBS -->
    <div class="pt-10 text-sm text-[#8D9399]">
      <a href="/about/index.html" class="hover:text-[#24272A]">О музее</a>
      <span class="mx-2">/</span>
      <span class="text-[#24272A]">Научная деятельность</span>
    </div>

    <!-- TITLE + RESET -->
    <div class="mt-6 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
      <h1 class="font-['Racama'] text-[40px] sm:text-[56px] lg:text-[72px] leading-[1.05]">
        Научная деятельность
      </h1>

      <button
        id="resetBtn"
        class="hidden items-center gap-3 border border-[#24272A] px-6 py-3 text-sm font-semibold"
      >
        Очистить фильтры
        <span class="text-xl leading-none">×</span>
      </button>
    </div>

    <!-- FILTERS -->
    <div class="mt-10 space-y-6">

      <!-- YEARS -->
      <div>
        <div class="text-sm font-semibold mb-3">Годы</div>
        <div class="flex flex-wrap gap-4">
          <input type="number" placeholder="2020"
                 class="filter-input w-[120px] border border-[#DCDEE0] px-4 py-3">
          <input type="number" placeholder="2025"
                 class="filter-input w-[120px] border border-[#DCDEE0] px-4 py-3">
        </div>
      </div>

      <!-- PLACE -->
      <div class="flex flex-wrap gap-6">
        <label class="flex items-center gap-3 cursor-pointer">
          <input type="radio" name="place" value="all"
                 class="filter-input accent-[#C93635]" checked>
          <span>Все</span>
        </label>

        <label class="flex items-center gap-3 cursor-pointer">
          <input type="radio" name="place" value="inside"
                 class="filter-input accent-[#C93635]">
          <span>В музее</span>
        </label>

        <label class="flex items-center gap-3 cursor-pointer">
          <input type="radio" name="place" value="outside"
                 class="filter-input accent-[#C93635]">
          <span>Вне музея</span>
        </label>
      </div>
    </div>

    <!-- CARDS -->
    <section class="mt-14 grid gap-x-6 gap-y-12 sm:grid-cols-2 lg:grid-cols-4">

      <article>
        <img
          data-src="/assets/img/about/science/1.png"
          alt=""
          class="lazy-img w-full aspect-[4/3] object-cover mb-4 bg-[#F3F4F6]"
        >
        <div class="text-sm text-[#8D9399] mb-2">
          16 ноября 2023 — 17 ноября 2023
        </div>
        <h3 class="text-base leading-[160%]">
          «Проблемы изучения и экспонирования народного и декоративно-прикладного искусства»
        </h3>
      </article>

      <article>
        <img data-src="/assets/img/about/science/2.png"
             class="lazy-img w-full aspect-[4/3] object-cover mb-4 bg-[#F3F4F6]">
        <div class="text-sm text-[#8D9399] mb-2">
          29 февраля 2024 — 29 марта 2024
        </div>
        <h3 class="text-base leading-[160%]">
          Научно-практическая конференция «XX век: время, события, люди»
        </h3>
      </article>

      <article>
        <img data-src="/assets/img/about/science/3.png"
             class="lazy-img w-full aspect-[4/3] object-cover mb-4 bg-[#F3F4F6]">
        <div class="text-sm text-[#8D9399] mb-2">
          21 ноября 2023 — 21 ноября 2023
        </div>
        <h3 class="text-base leading-[160%]">
          X Международная научная конференция «Троице-Сергиева Лавра»
        </h3>
      </article>

      <article>
        <img data-src="/assets/img/about/science/4.png"
             class="lazy-img w-full aspect-[4/3] object-cover mb-4 bg-[#F3F4F6]">
        <div class="text-sm text-[#8D9399] mb-2">
          31 мая 2023 — 31 мая 2023
        </div>
        <h3 class="text-base leading-[160%]">
          Научная конференция «Любовью и единением спасемся»
        </h3>
      </article>

    </section>

  </main>

  <!-- FOOTER -->
  <div data-include="/tpl/footer.html"></div>

  <!-- INCLUDE -->
  <script src="/include.js"></script>

  <!-- Alpine -->
  <script src="https://unpkg.com/alpinejs" defer></script>

  <!-- FIX HEADER DROPDOWNS -->
  <script>
    window.addEventListener('load', () => {
      document.querySelectorAll('details[open]').forEach(d => {
        d.removeAttribute('open');
      });
    });
  </script>

  <!-- FILTER LOGIC -->
  <script>
    const inputs = document.querySelectorAll('.filter-input');
    const resetBtn = document.getElementById('resetBtn');

    function checkFilters() {
      const yearsActive = [...inputs].some(i => i.type === 'number' && i.value);
      const radio = [...inputs].find(i => i.type === 'radio' && i.checked);
      const radioActive = radio && radio.value !== 'all';
      const active = yearsActive || radioActive;

      resetBtn.classList.toggle('hidden', !active);
      resetBtn.classList.toggle('flex', active);
    }

    inputs.forEach(i => {
      i.addEventListener('input', checkFilters);
      i.addEventListener('change', checkFilters);
    });

    resetBtn.addEventListener('click', () => {
      inputs.forEach(i => {
        if (i.type === 'number') i.value = '';
        if (i.type === 'radio') i.checked = i.value === 'all';
      });
      checkFilters();
    });

    checkFilters();
  </script>

  <!-- LAZY LOAD IMAGES -->
  <script>
    const lazyImages = document.querySelectorAll('.lazy-img');

    const observer = new IntersectionObserver((entries, obs) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          img.src = img.dataset.src;
          img.removeAttribute('data-src');
          obs.unobserve(img);
        }
      });
    }, {
      rootMargin: '200px'
    });

    lazyImages.forEach(img => observer.observe(img));
  </script>

</body>
</html>
